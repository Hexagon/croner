<!DOCTYPE html>
<html lang="en"><head>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark">
    <link rel="canonical" href="http://localhost:8000/usage/examples/">

    <!-- Specific -->
    <title>Croner - hexagon.56k.guru</title>
 
    <!-- Pico CSS -->
    <link rel="stylesheet" href="/css/pico.min.css" inline="">

    <!-- GitHub Dark Hightlight.js Theme -->
    <link href="/css/github-dark.min.css" rel="stylesheet">

    <!-- Local CSS -->
    <link href="/css/style.css" rel="stylesheet" inline="">
    
    <!-- Theme switcher -->
    <script src="/js/theme-switcher.js" inline=""></script>
        
    <!-- Hamburger Menu -->
    <script src="/js/hamburger.js" inline=""></script>

    <!-- Overridable custom content -->
    <script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9224018205432249" crossorigin="anonymous"></script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-873B7M42VH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-873B7M42VH');
</script>


  <meta property="og:type" content="website">
<meta property="og:site_name" content="Croner">
<meta property="og:locale" content="en">
<meta property="og:description" content="Cron for JavaScript and TypeScript">
<meta property="og:url" content="http://localhost:8000/usage/examples/">
<meta name="twitter:card" content="summary">
<meta itemprop="description" content="Cron for JavaScript and TypeScript">
<meta name="description" content="Cron for JavaScript and TypeScript">
</head>
  <body>

  <header class="container-fluid">
    <div class="container">
    <nav>
  <ul>

    <!-- Hamburger Icon -->
    <li id="hamburger-wrapper">
      <div id="hamburger-btn">
      <i class="fas fa-bars"></i>
      </div>
    </li>

    <!-- Brand Name -->
    <li>
      <a class="navbar-brand" href="/">
        Croner
      </a>
    </li>

  </ul>
  <ul>

    <!-- Light/Dark Theme Selector -->
    <li><span id="theme-switcher"><i id="theme-icon" class="fas fa-moon"></i></span></li>

    <!-- Aux Top Links -->
    
      <li>
        <a href="https://github.com/hexagon/croner" title="GitHub Repsitory">
          <i class="fab fa-github"></i>
        </a>
      </li>
    
      <li>
        <a href="https://deno.land/x/croner" title="Deno.land/x">
          <i class="fas fa-cube"></i>
        </a>
      </li>
    
      <li>
        <a href="https://npmjs.com/package/croner" title="NPM Library">
          <i class="fab fa-npm"></i>
        </a>
      </li>
    
  </ul>      
</nav>

    </div>
  </header>

  <div class="main-wrapper">
    <main class="container">
      <!-- content -->
      <div class="grid">

  <!-- Sidebar -->
  <aside>
    <nav>
    <ul>
        <!-- Page Hierarchy -->
        
            
                <li class="level0 bold">
                    <a href="/">Overview</a>
                </li>
                
                
            
        
            
        
            
                <li class="level0 bold">
                    <a href="/installation/">Installation</a>
                </li>
                
                
            
        
            
        
            
        
            
        
            
                <li class="level0 bold">
                    <a href="/usage/">Usage</a>
                </li>
                
                
                    <li class="level1">
                        <a href="/usage/basics/">Basics</a>
                    </li>
                    
                    
                
                    <li class="level1">
                        <a href="/usage/pattern/">Pattern</a>
                    </li>
                    
                    
                
                    <li class="level1">
                        <a href="/usage/configuration/">Configuration</a>
                    </li>
                    
                    
                
                    <li class="level1">
                        <a href="/usage/examples/"></a>
                    </li>
                    
                    
                
            
        
            
                <li class="level0 bold">
                    <a href="/migration/">Migration</a>
                </li>
                
                
            
        
            
                <li class="level0 bold">
                    <a href="/contributing/">Contributing</a>
                </li>
                
                
            
        
            
                <li class="level0 bold">
                    <a href="/sponsors/">Donations</a>
                </li>
                
                
            
        

        <!-- Spacer -->
        <li><!-- Spacer -->&nbsp;</li>

        <!-- Adding navLinks from _data.json -->
        
            <li class="level0">
                <a href="https://github.com/hexagon/croner" title="GitHub Repsitory">
                    GitHub Repsitory <i class="fa fa-external-link" aria-hidden="true"></i>
                </a>
            </li>
        
            <li class="level0">
                <a href="https://deno.land/x/croner" title="Deno.land/x">
                    Deno.land/x <i class="fa fa-external-link" aria-hidden="true"></i>
                </a>
            </li>
        
            <li class="level0">
                <a href="https://npmjs.com/package/croner" title="NPM Library">
                    NPM Library <i class="fa fa-external-link" aria-hidden="true"></i>
                </a>
            </li>
        
    </ul>
</nav>

<!-- Sidebar custom content -->
  </aside>

  <section>
      <!--<div id="search"></div>-->
      <h1>Examples</h1>
<hr>
<ol :toc="" %="" include="" multiplex.html="">
<li>TOC</li>
</ol>
<h3>Find dates</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs"><span class="hljs-comment">// Find next month</span>
<span class="hljs-keyword">const</span> nextMonth = <span class="hljs-title class_">Cron</span>(<span class="hljs-string">"@monthly"</span>).<span class="hljs-title function_">nextRun</span>(),
	nextSunday = <span class="hljs-title class_">Cron</span>(<span class="hljs-string">"@weekly"</span>).<span class="hljs-title function_">nextRun</span>(),
	nextSat29feb = <span class="hljs-title class_">Cron</span>(<span class="hljs-string">"0 0 0 29 2 6"</span>, { <span class="hljs-attr">legacyMode</span>: <span class="hljs-literal">false</span> }).<span class="hljs-title function_">nextRun</span>(),
	nextSunLastOfMonth = <span class="hljs-title class_">Cron</span>(<span class="hljs-string">"0 0 0 L * 7"</span>, { <span class="hljs-attr">legacyMode</span>: <span class="hljs-literal">false</span> }).<span class="hljs-title function_">nextRun</span>(),
    nextLastSundayOfMonth = <span class="hljs-title class_">Cron</span>(<span class="hljs-string">"0 0 0 * * L7"</span>).<span class="hljs-title function_">nextRun</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"First day of next month: "</span> +  nextMonth.<span class="hljs-title function_">toLocaleDateString</span>());
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Next sunday: "</span> +  nextSunday.<span class="hljs-title function_">toLocaleDateString</span>());
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Next saturday at 29th of february: "</span> +  nextSat29feb.<span class="hljs-title function_">toLocaleDateString</span>());  <span class="hljs-comment">// 2048-02-29</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Next month ending with a sunday: "</span> +  nextSunLastOfMonth.<span class="hljs-title function_">toLocaleDateString</span>());
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Next last sunday of month: "</span> +  nextLastSundayOfMonth.<span class="hljs-title function_">toLocaleDateString</span>());
</code></pre>
<h3>Job controls</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs"><span class="hljs-keyword">const</span> job = <span class="hljs-title class_">Cron</span>(<span class="hljs-string">'* * * * * *'</span>, <span class="hljs-function">(<span class="hljs-params">self</span>) =&gt;</span> {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This will run every second. Pause on second 10. Resume on 15. And quit on 20.'</span>);
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Current second: '</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getSeconds</span>());
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Previous run: '</span> + self.<span class="hljs-title function_">previousRun</span>());
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Next run: '</span> + self.<span class="hljs-title function_">nextRun</span>());
});

<span class="hljs-title class_">Cron</span>(<span class="hljs-string">'10 * * * * *'</span>, {<span class="hljs-attr">maxRuns</span>: <span class="hljs-number">1</span>}, <span class="hljs-function">() =&gt;</span> job.<span class="hljs-title function_">pause</span>());
<span class="hljs-title class_">Cron</span>(<span class="hljs-string">'15 * * * * *'</span>, {<span class="hljs-attr">maxRuns</span>: <span class="hljs-number">1</span>}, <span class="hljs-function">() =&gt;</span> job.<span class="hljs-title function_">resume</span>());
<span class="hljs-title class_">Cron</span>(<span class="hljs-string">'20 * * * * *'</span>, {<span class="hljs-attr">maxRuns</span>: <span class="hljs-number">1</span>}, <span class="hljs-function">() =&gt;</span> job.<span class="hljs-title function_">stop</span>());
</code></pre>
<h3>Options</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Cron</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"./dist/croner.js"</span>;

<span class="hljs-keyword">const</span> job = <span class="hljs-title class_">Cron</span>(
	<span class="hljs-string">'* * * * *'</span>, 
	{
		<span class="hljs-attr">startAt</span>: <span class="hljs-string">"2023-11-01T00:00:00"</span>, 
		<span class="hljs-attr">stopAt</span>: <span class="hljs-string">"2023-12-01T00:00:00"</span>,
		<span class="hljs-attr">timezone</span>: <span class="hljs-string">"Europe/Stockholm"</span>
	},
	<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This will run every minute, from 2023-11-01 to 2023-12-01 00:00:00'</span>);
	}
);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Will run first time at'</span>, job.<span class="hljs-title function_">nextRun</span>().<span class="hljs-title function_">toLocaleString</span>());
</code></pre>
<h3>Interval</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs"><span class="hljs-comment">// Trigger on specific interval combined with cron expression</span>
<span class="hljs-title class_">Cron</span>(<span class="hljs-string">'* * 7-16 * * MON-FRI'</span>, { <span class="hljs-attr">interval</span>: <span class="hljs-number">90</span> }, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This will trigger every 90th second at 7-16 on mondays to fridays.'</span>);
});
</code></pre>
<h3>Passing a context</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs"><span class="hljs-keyword">const</span> data = {
	<span class="hljs-attr">what</span>: <span class="hljs-string">"stuff"</span>
};

<span class="hljs-title class_">Cron</span>(<span class="hljs-string">'* * * * * *'</span>, { <span class="hljs-attr">context</span>: data }, <span class="hljs-function">(<span class="hljs-params">_self, context</span>) =&gt;</span> {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This will print stuff: '</span> + context.<span class="hljs-property">what</span>);
});

<span class="hljs-title class_">Cron</span>(<span class="hljs-string">'*/5 * * * * *'</span>, { <span class="hljs-attr">context</span>: data }, <span class="hljs-function">(<span class="hljs-params">self, context</span>) =&gt;</span> {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'After this, other stuff will be printed instead'</span>);
	context.<span class="hljs-property">what</span> = <span class="hljs-string">"other stuff"</span>;
	self.<span class="hljs-title function_">stop</span>();
});
</code></pre>
<h3>Fire on a specific date/time</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs"><span class="hljs-comment">// A javascript date, or a ISO 8601 local time string can be passed, to fire a function once. </span>
<span class="hljs-comment">// Always specify which timezone the ISO 8601 time string has with the timezone option.</span>
<span class="hljs-keyword">let</span> job = <span class="hljs-title class_">Cron</span>(<span class="hljs-string">"2025-01-01T23:00:00"</span>,{<span class="hljs-attr">timezone</span>: <span class="hljs-string">"Europe/Stockholm"</span>},<span class="hljs-function">() =&gt;</span> {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This will run at 2025-01-01 23:00:00 in timezone Europe/Stockholm'</span>);
});

<span class="hljs-keyword">if</span> (job.<span class="hljs-title function_">nextRun</span>() === <span class="hljs-literal">null</span>) {
	<span class="hljs-comment">// The job will not fire for some reason</span>
} <span class="hljs-keyword">else</span> {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Job will fire at "</span> + job.<span class="hljs-title function_">nextRun</span>());
}
</code></pre>
<h3>Time zone</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs"><span class="hljs-keyword">let</span> job = <span class="hljs-title class_">Cron</span>(<span class="hljs-string">"0 0 14 * * *"</span>, { <span class="hljs-attr">timezone</span>: <span class="hljs-string">"Europe/Stockholm"</span> }, <span class="hljs-function">() =&gt;</span> {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This will every day at 14:00 in time zone Europe/Stockholm'</span>);
});


<span class="hljs-keyword">if</span> (job.<span class="hljs-title function_">nextRun</span>() === <span class="hljs-literal">null</span>) {
	<span class="hljs-comment">// The job will not fire for some reason</span>
} <span class="hljs-keyword">else</span> {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Job will fire at "</span> + job.<span class="hljs-title function_">nextRun</span>());
}
</code></pre>
<h3>Naming jobs</h3>
<p>If you provide a name for the job using the option { name: '...' }, a reference to the job will be stored in the exported array <code>scheduledJobs</code>. Naming a job makes it accessible throughout your application.</p>
<p>{: .note }
If a job is stopped using <code>.stop()</code>, it will be removed from the scheduledJobs array.</p>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs"><span class="hljs-comment">// import { Cron, scheduledJobs } ...</span>

<span class="hljs-comment">// Scoped job</span>
(<span class="hljs-function">() =&gt;</span> {

	<span class="hljs-comment">// As we specify a name for the job, a reference will be kept in `scheduledJobs`</span>
	<span class="hljs-keyword">const</span> job = <span class="hljs-title class_">Cron</span>(<span class="hljs-string">"* * * * * *"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">"Job1"</span> }, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) {
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"This will run every second"</span>);
	});

	job.<span class="hljs-title function_">pause</span>();
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Job paused"</span>);

})();

<span class="hljs-comment">// Another scope, delayed 5 seconds</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {

	<span class="hljs-comment">// Find our job</span>
	<span class="hljs-comment">// - scheduledJobs can either be imported separately { Cron, scheduledJobs }</span>
	<span class="hljs-comment">//   or access through Cron.scheduledJobs</span>
	<span class="hljs-keyword">const</span> job = scheduledJobs.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">j</span> =&gt;</span> j.<span class="hljs-property">name</span> === <span class="hljs-string">"Job1"</span>);

	<span class="hljs-comment">// Resume it</span>
	<span class="hljs-keyword">if</span> (job) {
		<span class="hljs-keyword">if</span>(job.<span class="hljs-title function_">resume</span>()) {
			<span class="hljs-comment">// This will happen</span>
			<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Job resumed successfully"</span>);
		} <span class="hljs-keyword">else</span> {
			<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Job found, but could not be restarted. This should never happen, as the named jobs is _removed_ when using `.stop()`."</span>);
		}
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Job not found"</span>);
	}

}, <span class="hljs-number">5000</span>);

</code></pre>
<h3>Act at completion</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs"><span class="hljs-comment">// Start a job firing once each 5th second, run at most 3 times</span>
<span class="hljs-keyword">const</span> job = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cron</span>(<span class="hljs-string">"0/5 * * * * *"</span>, { <span class="hljs-attr">maxRuns</span>: <span class="hljs-number">3</span> }, <span class="hljs-function">(<span class="hljs-params">job</span>) =&gt;</span> {
    
    <span class="hljs-comment">// Do work</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Job Running'</span>);

    <span class="hljs-comment">// Is this the last execution?</span>
    <span class="hljs-keyword">if</span> (!job.<span class="hljs-title function_">nextRun</span>()) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Last execution'</span>);
    }

});
 
<span class="hljs-comment">// Will there be no executions? </span>
<span class="hljs-comment">// This would trigger if you change maxRuns to 0, or manage to compose </span>
<span class="hljs-comment">// an impossible cron expression.</span>
<span class="hljs-keyword">if</span> (!job.<span class="hljs-title function_">nextRun</span>() &amp;&amp; !job.<span class="hljs-title function_">previousRun</span>()) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'No executions scheduled'</span>);
}
</code></pre>
<h3>Error handling</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs">
<span class="hljs-comment">// Prepare an error handler</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">errorHandler</span> = (<span class="hljs-params">e</span>) =&gt; {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e);
};

<span class="hljs-comment">// Start a job firing every second</span>
<span class="hljs-keyword">const</span> job = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cron</span>(<span class="hljs-string">"* * * * * *"</span>, { <span class="hljs-attr">catch</span>: errorHandler }, <span class="hljs-function">(<span class="hljs-params">job</span>) =&gt;</span> {
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This will print!'</span>);
	<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"This will be catched and printed by the error handler"</span>);
	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'This will not print, but the job will keep on triggering'</span>);
});

</code></pre>
<h3>Overrun protection</h3>
<pre class="language-javascript" tabindex="0"><code class="language-javascript hljs"><span class="hljs-comment">// Demo blocking function</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">blockForAWhile</span> = (<span class="hljs-params">ms</span>) =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, ms));

<span class="hljs-comment">// (Optional) Callback to be triggered on a blocked call</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">protectCallback</span> = (<span class="hljs-params">job</span>) =&gt; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Call at <span class="hljs-subst">${<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString()}</span> were blocked by call started at <span class="hljs-subst">${job.currentRun().toISOString()}</span>`</span>);

<span class="hljs-comment">// protect: can be set to ether true or a callback function, to enable over-run protection</span>
<span class="hljs-title class_">Cron</span>(<span class="hljs-string">"* * * * * *"</span>, { <span class="hljs-attr">protect</span>: protectCallback }, <span class="hljs-keyword">async</span> (job) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Call started at <span class="hljs-subst">${job.currentRun().toISOString()}</span> started`</span>);
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">blockForAWhile</span>(<span class="hljs-number">4000</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Call started at <span class="hljs-subst">${job.currentRun().toISOString()}</span> finished <span class="hljs-subst">${<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString()}</span>`</span>);
});

<span class="hljs-comment">/* Output
Call started at 2023-02-16T20:47:07.005Z started
Call at 2023-02-16T20:47:08.014Z were blocked by call started at 2023-02-16T20:47:07.005Z
Call at 2023-02-16T20:47:09.012Z were blocked by call started at 2023-02-16T20:47:07.005Z
Call at 2023-02-16T20:47:10.009Z were blocked by call started at 2023-02-16T20:47:07.005Z
Call at 2023-02-16T20:47:11.007Z were blocked by call started at 2023-02-16T20:47:07.005Z
Call started at 2023-02-16T20:47:07.005Z finished 2023-02-16T20:47:11.039Z
*/</span>
</code></pre>

  </section>
  
</div>
    </main>
  </div>

  <footer class="container-fluid">
    <div class="container">
      <div class="grid">
    <!-- Custom footer content -->
    <span class="right notice">Powered by <a href="https://lumocs.56k.guru">Lumocs</a>, a documentation theme for <a href="https://lume.land">Lume</a>.</span>
</div>
    </div>
  </footer>


</body></html>